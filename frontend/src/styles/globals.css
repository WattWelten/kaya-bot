@tailwind base;
@tailwind components;
@tailwind utilities;

/* CI-Farben (erweitert) */
:root {
  /* CI-Farben */
  --lc-primary-600: #0F766E;   /* Primär (Grün-Teal) */
  --lc-primary-700: #0B5C56;
  --lc-accent-600: #2563EB;    /* Akzent (Blau) */
  --lc-bg-50: #F7FAFB;         /* Hintergrund */
  --lc-ink-900: #0F172A;       /* Haupttext */
  --lc-ink-700: #334155;       /* Sekundärtext */
  --lc-border: #E2E8F0;        /* Linien */
}

/* CSS-Variablen für CI */
:root {
  /* Primary Colors (Teal/Grün) */
  --lc-primary-50: #EBF8F7;
  --lc-primary-100: #D1F2EB;
  --lc-primary-200: #BFE3DF;
  --lc-primary-300: #7DD3C4;
  --lc-primary-400: #4ECDC4;
  --lc-primary-500: #26A69A;
  --lc-primary-600: #0F766E;
  --lc-primary-700: #0A5A55;
  --lc-primary-800: #064E4B;
  --lc-primary-900: #043C39;

  /* Warm Tones */
  --color-primary: #26A69A;
  --color-primary-dark: #0F766E;
  --color-primary-light: #7DD3C4;
  
  /* Accent Colors */
  --color-success: #10B981;
  --color-warning: #F59E0B;
  --color-danger: #EF4444;
  
  /* Text Colors (warm) */
  --color-text-primary: #1F2937;
  --color-text-secondary: #6B7280;
  
  /* Easing Functions */
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
  --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-in-out-smooth: cubic-bezier(0.4, 0, 0.2, 1);

  /* Accent Colors (Blau) */
  --lc-accent-50: #EFF6FF;
  --lc-accent-100: #DBEAFE;
  --lc-accent-200: #BFDBFE;
  --lc-accent-300: #93C5FD;
  --lc-accent-400: #60A5FA;
  --lc-accent-500: #3B82F6;
  --lc-accent-600: #2563EB;
  --lc-accent-700: #1D4ED8;
  --lc-accent-800: #1E40AF;
  --lc-accent-900: #1E3A8A;

  /* Neutral Colors (Grau) */
  --lc-neutral-50: #F8FAFC;
  --lc-neutral-100: #F1F5F9;
  --lc-neutral-200: #E2E8F0;
  --lc-neutral-300: #CBD5E1;
  --lc-neutral-400: #94A3B8;
  --lc-neutral-500: #64748B;
  --lc-neutral-600: #475569;
  --lc-neutral-700: #334155;
  --lc-neutral-800: #1F2937;
  --lc-neutral-900: #0F172A;

  /* Animation Settings */
  --animation-duration: 300ms;
  --animation-iteration-count: 1;
  
  /* Gradient-Stops für animierten Hintergrund - CI */
  --gradient-from: #EBF8F7;
  --gradient-via: #FEF3C7;
  --gradient-to: #D1F2EB;
  
  /* Organische Formen - Wappen-Farben */
  --blob-1: #26A69A;  /* Türkis */
  --blob-2: #F59E0B;  /* Gold */
  --blob-3: #4ECDC4;  /* Helles Türkis */
  
  /* Timing-Funktionen */
  --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* Dark Theme Variablen */
.dark {
  --lc-neutral-50: #0F172A;
  --lc-neutral-100: #1F2937;
  --lc-neutral-200: #334155;
  --lc-neutral-300: #475569;
  --lc-neutral-400: #64748B;
  --lc-neutral-500: #94A3B8;
  --lc-neutral-600: #CBD5E1;
  --lc-neutral-700: #E2E8F0;
  --lc-neutral-800: #F1F5F9;
  --lc-neutral-900: #F8FAFC;
}

/* Base Styles */
@layer base {
  html {
    font-family: 'Inter', system-ui, sans-serif;
    scroll-behavior: smooth;
  }

  body {
    @apply bg-lc-neutral-50 text-lc-neutral-800;
    font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
    letter-spacing: -0.01em;
  }

  /* Focus Styles für Accessibility */
  *:focus {
    @apply outline-none ring-2 ring-lc-accent-600 ring-offset-2;
  }

  /* Reduced Motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* High Contrast Mode */
  .high-contrast * {
    color: #000 !important;
    background: #fff !important;
    border-color: #000 !important;
  }

  .high-contrast a {
    text-decoration: underline !important;
  }

  /* Simple Language Mode */
  [data-simple-language="true"] .chat-message p {
    font-size: 1.1rem !important;
    line-height: 1.8 !important;
  }

  [data-simple-language="true"] button {
    min-height: 44px !important;
    padding: 0.75rem 1.5rem !important;
    font-size: 1rem !important;
  }

  /* High Contrast Mode */
  @media (prefers-contrast: high) {
    .contrast-125 {
      filter: contrast(1.25);
    }
  }
}

/* Component Styles */
@layer components {
  /* Skiplink für Accessibility */
  .skiplink {
    @apply sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:bg-white focus:text-lc-neutral-900 focus:px-3 focus:py-1 focus:rounded-xl focus:shadow-soft focus:z-50;
  }

  /* Button Styles */
  .btn-ghost {
    @apply inline-flex items-center justify-center rounded-xl h-9 w-9 text-lc-neutral-700 hover:bg-lc-neutral-100 active:bg-lc-neutral-200 transition-colors duration-200 focus:ring-2 focus:ring-lc-accent-600 focus:ring-offset-2;
  }

  .btn-solid {
    @apply inline-flex items-center justify-center rounded-xl h-9 px-3 text-white shadow-sm transition-all duration-300 focus:ring-2 focus:ring-lc-gold-500 focus:ring-offset-2;
    background: linear-gradient(135deg, #F59E0B, #D97706);
    box-shadow: 0 4px 16px rgba(245, 158, 11, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }

  .btn-solid:hover {
    background: linear-gradient(135deg, #FBBF24, #F59E0B);
    box-shadow: 0 8px 32px rgba(245, 158, 11, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.4);
    transform: translateY(-2px);
  }

  .btn-solid:active {
    transform: translateY(0);
  }

  .btn-solid:disabled {
    @apply opacity-50 cursor-not-allowed;
    background: linear-gradient(135deg, #64748B, #475569);
    box-shadow: none;
  }

  /* Chip/Link Styles */
  .chip-link {
    @apply inline-flex items-center gap-1 rounded-full border border-lc-neutral-300 px-3 py-1 text-sm hover:bg-lc-neutral-100 active:bg-lc-neutral-200 transition-colors duration-200 focus:ring-2 focus:ring-lc-accent-600 focus:ring-offset-2;
  }

  /* Einfache Sprache */
  .simple-language p {
    line-height: 1.6;
    font-size: 1.05rem;
  }

  .simple-language .chip-link {
    @apply text-base py-2 px-4;
  }

  .simple-language .btn-ghost,
  .simple-language .btn-solid {
    @apply h-10 px-4;
  }

  /* Reduced Motion Override */
  .reduce-motion * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Utility Classes */
@layer utilities {
  /* Custom Scrollbar */
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: theme('colors.lc-neutral-300') theme('colors.lc-neutral-100');
  }

  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background: theme('colors.lc-neutral-100');
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: theme('colors.lc-neutral-300');
    border-radius: 3px;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: theme('colors.lc-neutral-400');
  }

  /* 9:16 Mobile-First Optimierungen */
  @media (min-width: 768px) {
    /* Desktop: Zentriert mit max-width */
    main {
      max-width: 480px;
      margin: 0 auto;
      box-shadow: 0 0 50px rgba(0, 0, 0, 0.1);
    }
  }

  /* Chat-Overlay: Text läuft hinter Avatar aus (Fade-Out) */
  #chat-root .overflow-y-auto::after {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 0;
    right: 0;
    height: 30px;
    background: linear-gradient(to top, white, transparent);
    pointer-events: none;
  }

  /* Award-würdige Micro-Interactions */
  @keyframes gentle-float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-5px); }
  }

  @keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 20px rgba(15, 118, 110, 0.3); }
    50% { box-shadow: 0 0 35px rgba(15, 118, 110, 0.6); }
  }

  @keyframes audio-pulse {
    0%, 100% { 
      transform: scale(1); 
      box-shadow: 0 0 20px rgba(239, 68, 68, 0.5); 
    }
    50% { 
      transform: scale(1.1); 
      box-shadow: 0 0 40px rgba(239, 68, 68, 0.8); 
    }
  }

  /* Avatar-Bereich: Subtiler Float-Effekt */
  #avatar-section,
  section[aria-label="Avatar Bereich"] {
    animation: gentle-float 6s ease-in-out infinite;
  }

  /* Audio-Button: Premium Glow */
  button[aria-label*="Aufnahme"] {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  button[aria-label*="Aufnahme"]:not(:disabled):hover {
    transform: scale(1.08) translateY(-2px);
    filter: brightness(1.1);
  }

  /* Chat-Messages: Slide-In Animation */
  @keyframes slide-in-bottom {
    from {
      opacity: 0;
      transform: translateY(15px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #chat-root > div > div[class*="flex"] {
    animation: slide-in-bottom 0.3s ease-out;
  }

  /* Header: Subtiler Shadow on Scroll */
  header.scrolled {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: box-shadow 0.3s ease;
  }

  /* Desktop: Eleganter Box-Shadow */
  @media (min-width: 768px) {
    main {
      box-shadow: 
        0 0 60px rgba(15, 118, 110, 0.12),
        0 20px 40px rgba(30, 77, 123, 0.08);
    }
  }

  /* Text Selection */
  ::selection {
    background: theme('colors.lc-primary-200');
    color: theme('colors.lc-primary-900');
  }

  /* Print Styles */
  @media print {
    .no-print {
      display: none !important;
    }
  }
}

/* Three.js Canvas Styles */
.three-canvas {
  width: 100%;
  height: 100%;
  display: block;
  background: transparent;
  outline: none;
}

/* Loading Animation */
@keyframes pulse-soft {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.8;
  }
}

.animate-pulse-soft {
  animation: pulse-soft 2s ease-in-out infinite;
}

/* Glassmorphism */
.glass {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(10px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.glass-dark {
  background: rgba(31, 41, 55, 0.7);
  backdrop-filter: blur(10px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Gradient Buttons */
.btn-gradient {
  background: linear-gradient(135deg, var(--lc-primary-500), var(--lc-accent-500));
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  border: none;
  color: white;
  font-weight: 500;
}

.btn-gradient:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(38, 166, 154, 0.3);
}

.btn-gradient:active {
  transform: translateY(0);
}

/* Chat Message Animations */
@keyframes messageSlideIn {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.message-animate {
  animation: messageSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Button Interactive Effects */
.btn-interactive {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.btn-interactive:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px rgba(38, 166, 154, 0.25);
}

.btn-interactive:active {
  transform: scale(0.98);
}

/* Chat Bubble Enhancements */
.chat-message-assistant {
  background: linear-gradient(135deg, #ffffff 0%, #f8fcfb 100%);
  border: none;
  box-shadow: 
    0 2px 12px rgba(38, 166, 154, 0.08),
    0 1px 4px rgba(0, 0, 0, 0.04);
  border-radius: 20px;
  padding: 16px 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-message-assistant:hover {
  box-shadow: 
    0 4px 20px rgba(38, 166, 154, 0.12),
    0 2px 8px rgba(0, 0, 0, 0.06);
  transform: translateY(-2px);
}

.chat-message-user {
  background: linear-gradient(135deg, #26A69A 0%, #0F766E 100%);
  box-shadow: 
    0 4px 16px rgba(38, 166, 154, 0.25),
    0 2px 8px rgba(0, 0, 0, 0.1);
  color: white;
}

/* Quick Actions with Glow */
.quick-action {
  position: relative;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.quick-action::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, #26A69A, #4ECDC4);
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: -1;
}

.quick-action:hover {
  border-color: transparent;
  color: white;
  box-shadow: 0 8px 24px rgba(38, 166, 154, 0.3);
  transform: translateY(-3px);
}

.quick-action:hover::before {
  opacity: 1;
}

/* Mic Button Pulsing Glow */
.mic-button {
  box-shadow: 
    0 4px 16px rgba(38, 166, 154, 0.3),
    0 0 0 0 rgba(38, 166, 154, 0.4);
  animation: pulse-glow 2s infinite;
}

@keyframes pulse-glow {
  0%, 100% {
    box-shadow: 
      0 4px 16px rgba(38, 166, 154, 0.3),
      0 0 0 0 rgba(38, 166, 154, 0.4);
  }
  50% {
    box-shadow: 
      0 4px 20px rgba(38, 166, 154, 0.4),
      0 0 0 8px rgba(38, 166, 154, 0.1);
  }
}

.mic-button.recording {
  background: linear-gradient(135deg, #ef4444, #dc2626);
  animation: pulse-red 1s infinite;
}

@keyframes pulse-red {
  0%, 100% {
    box-shadow: 
      0 4px 16px rgba(239, 68, 68, 0.4),
      0 0 0 0 rgba(239, 68, 68, 0.4);
  }
  50% {
    box-shadow: 
      0 4px 20px rgba(239, 68, 68, 0.6),
      0 0 0 12px rgba(239, 68, 68, 0.2);
  }
}

/* Input Field Focus Glow */
.message-input {
  border: 2px solid rgba(38, 166, 154, 0.15);
  transition: all 0.3s ease;
  background: white;
}

.message-input:focus {
  border-color: transparent;
  box-shadow: 
    0 0 0 3px rgba(38, 166, 154, 0.1),
    0 4px 16px rgba(38, 166, 154, 0.15);
  outline: none;
}

/* Success Animation */
@keyframes success-pop {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.success-checkmark {
  animation: success-pop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* Accessibility Toolbar Enhancement */
.accessibility-toolbar {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.8);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.08),
    0 4px 16px rgba(0, 0, 0, 0.04),
    inset 0 1px 0 rgba(255, 255, 255, 0.8);
  padding: 16px;
}

/* Fade In Animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Slide Up Animation */
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-up {
  animation: slideUp 0.3s ease-out;
}

/* Scale In Animation */
@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-scale-in {
  animation: scaleIn 0.3s ease-out;
}

/* Responsive Design - Typography */
:root {
  /* Mobile-first Font-Sizes */
  font-size: 16px;
}

/* Mobile (< 768px) */
@media (max-width: 768px) {
  .mobile-hidden {
    display: none;
  }
  
  .mobile-full {
    width: 100%;
  }

  /* Typography Mobile */
  h1 { font-size: 1.5rem; line-height: 1.4; }
  h2 { font-size: 1.25rem; line-height: 1.4; }
  h3 { font-size: 1.125rem; line-height: 1.5; }
  p, span { font-size: 1rem; line-height: 1.6; }

  /* Touch-Targets min. 44x44px */
  button, .btn-ghost, .btn-solid {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Tablet (768px - 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
  h1 { font-size: 1.75rem; }
  h2 { font-size: 1.5rem; }
  h3 { font-size: 1.25rem; }
  p, span { font-size: 0.95rem; }
}

/* Desktop (> 1024px) */
@media (min-width: 1024px) {
  h1 { font-size: 2rem; }
  h2 { font-size: 1.75rem; }
  h3 { font-size: 1.5rem; }
  p, span { font-size: 1rem; }
}

/* High DPI Displays */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .high-dpi {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}

/* Screen Reader Only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: 0.5rem;
  margin: 0;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ============================================
   KAYA UI/UX REDESIGN - PHASE 2 & 3
   ============================================ */

/* Animierter Organischer Hintergrund - CI */
.animated-background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  background: linear-gradient(135deg, var(--gradient-from) 0%, var(--gradient-via) 50%, var(--gradient-to) 100%);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
  overflow: hidden;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.animated-background::before,
.animated-background::after {
  content: '';
  position: absolute;
  border-radius: 50%;
  filter: blur(80px);
  opacity: 0.4;
  animation: float-blob 20s ease-in-out infinite;
}

.animated-background::before {
  width: 600px;
  height: 600px;
  background: radial-gradient(circle, var(--blob-1), var(--blob-2));
  top: -10%;
  left: -10%;
  animation-delay: 0s;
}

.animated-background::after {
  width: 500px;
  height: 500px;
  background: radial-gradient(circle, var(--blob-2), var(--blob-3));
  bottom: -10%;
  right: -10%;
  animation-delay: 7s;
}

.blob-3 {
  position: absolute;
  width: 400px;
  height: 400px;
  background: radial-gradient(circle, var(--blob-3), var(--blob-1));
  border-radius: 50%;
  filter: blur(80px);
  opacity: 0.35;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: float-blob 25s ease-in-out infinite reverse;
}

@keyframes float-blob {
  0%, 100% {
    transform: translate(0, 0) scale(1);
  }
  33% {
    transform: translate(50px, -50px) scale(1.1);
  }
  66% {
    transform: translate(-50px, 50px) scale(0.9);
  }
}

/* Reduced Motion Override */
@media (prefers-reduced-motion: reduce) {
  .animated-background::before,
  .animated-background::after,
  .blob-3 {
    animation: none !important;
  }
}

/* Moderne Glassmorphism Chat-Bubbles mit CI */
.chat-message-assistant {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.95) 0%, 
    rgba(235, 248, 247, 0.95) 40%,
    rgba(191, 227, 223, 0.9) 100%
  );
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 2px solid rgba(38, 166, 154, 0.3);
  box-shadow: 
    0 8px 32px rgba(38, 166, 154, 0.15),
    0 0 60px rgba(245, 158, 11, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.9);
  border-radius: 24px;
  padding: 18px 24px;
  position: relative;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-message-assistant::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, 
    transparent,
    rgba(245, 158, 11, 0.8) 25%,
    rgba(38, 166, 154, 0.9) 50%,
    rgba(245, 158, 11, 0.8) 75%,
    transparent
  );
  opacity: 0;
  transition: opacity 0.4s ease;
}

.chat-message-assistant:hover {
  transform: translateY(-2px);
  box-shadow: 
    0 12px 40px rgba(38, 166, 154, 0.25),
    0 0 60px rgba(245, 158, 11, 0.12),
    0 4px 12px rgba(0, 0, 0, 0.06),
    inset 0 1px 0 rgba(255, 255, 255, 1);
  border-color: rgba(38, 166, 154, 0.5);
}

.chat-message-assistant:hover::before {
  opacity: 1;
}

.chat-message-user {
  background: linear-gradient(135deg, 
    #26A69A 0%, 
    #0F766E 50%,
    #064E4B 100%
  );
  box-shadow: 
    0 8px 24px rgba(38, 166, 154, 0.45),
    0 0 32px rgba(245, 158, 11, 0.15),
    0 2px 8px rgba(0, 0, 0, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.25);
  border: 2px solid rgba(255, 255, 255, 0.2);
  color: white;
  border-radius: 24px;
  padding: 18px 24px;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-message-user:hover {
  transform: translateY(-2px);
  box-shadow: 
    0 12px 32px rgba(38, 166, 154, 0.55),
    0 0 48px rgba(245, 158, 11, 0.25),
    0 4px 12px rgba(0, 0, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.35);
  border-color: rgba(255, 255, 255, 0.3);
}

/* Chat-Container mit Glassmorphism */
.chat-container-glass {
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(30px) saturate(180%);
  -webkit-backdrop-filter: blur(30px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-shadow: 
    0 20px 60px rgba(0, 0, 0, 0.08),
    0 8px 24px rgba(0, 0, 0, 0.04);
  border-radius: 32px;
}

/* Enhanced Button Interactions */
.btn-interactive {
  position: relative;
  overflow: hidden;
  transition: all 0.4s var(--ease-elastic);
}

.btn-interactive::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.5) 0%, transparent 70%);
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
  border-radius: 50%;
}

.btn-interactive:active::before {
  width: 300px;
  height: 300px;
}

/* Quick-Action mit Glow-Effekt */
.quick-action {
  position: relative;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 8px rgba(38, 166, 154, 0.1);
}

.quick-action:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 
    0 12px 32px rgba(38, 166, 154, 0.25),
    0 0 0 4px rgba(38, 166, 154, 0.1);
  background: linear-gradient(135deg, #26A69A, #4ECDC4);
  color: white;
  border-color: transparent;
}

/* Input-Field mit Glow-Focus */
.message-input {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 2px solid rgba(38, 166, 154, 0.2);
  transition: all 0.3s ease;
  border-radius: 16px;
}

.message-input:focus {
  background: rgba(255, 255, 255, 1);
  border-color: #26A69A;
  box-shadow: 
    0 0 0 4px rgba(38, 166, 154, 0.1),
    0 8px 24px rgba(38, 166, 154, 0.2);
  outline: none;
}

/* Mic-Button mit Pulse */
.mic-button {
  background: linear-gradient(135deg, #26A69A, #0F766E);
  box-shadow: 
    0 4px 16px rgba(38, 166, 154, 0.4),
    0 0 0 0 rgba(38, 166, 154, 0);
  transition: all 0.3s ease;
}

.mic-button:hover {
  transform: scale(1.08);
  box-shadow: 
    0 8px 24px rgba(38, 166, 154, 0.5),
    0 0 0 8px rgba(38, 166, 154, 0.15);
}

.mic-button.recording {
  background: linear-gradient(135deg, #ef4444, #dc2626);
  animation: pulse-recording 1.5s ease-in-out infinite;
}

@keyframes pulse-recording {
  0%, 100% {
    box-shadow: 
      0 4px 16px rgba(239, 68, 68, 0.5),
      0 0 0 0 rgba(239, 68, 68, 0.7);
  }
  50% {
    box-shadow: 
      0 8px 24px rgba(239, 68, 68, 0.6),
      0 0 0 16px rgba(239, 68, 68, 0);
  }
}

/* Message Slide-In mit Bounce */
@keyframes messageSlideInBounce {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.92);
  }
  60% {
    opacity: 1;
    transform: translateY(-4px) scale(1.02);
  }
  100% {
    transform: translateY(0) scale(1);
  }
}

.message-animate {
  animation: messageSlideInBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* Float Animation für Dekorations-Elemente */
@keyframes float {
  0%, 100% {
    transform: translateY(0) rotate(0deg);
  }
  50% {
    transform: translateY(-15px) rotate(5deg);
  }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

/* Mobile Optimierungen */
@media (max-width: 768px) {
  .animated-background::before,
  .animated-background::after,
  .blob-3 {
    filter: blur(60px);
    opacity: 0.2;
  }
  
  .chat-container-glass {
    border-radius: 24px;
  }
  
  .chat-message-assistant,
  .chat-message-user {
    border-radius: 18px;
    padding: 14px 18px;
  }
}

/* Tablet Optimierungen */
@media (min-width: 769px) and (max-width: 1024px) {
  .animated-background::before {
    width: 500px;
    height: 500px;
  }
  
  .animated-background::after {
    width: 400px;
    height: 400px;
  }
}

/* Quellen-Fußzeile */
.source-footer {
  margin-top: 1rem;
  padding-top: 0.75rem;
  border-top: 1px solid rgba(203, 213, 225, 0.5);
  font-size: 0.875rem;
  color: #6B7280;
  font-style: italic;
}

.source-footer strong {
  color: #475569;
  font-weight: 500;
}

/* Voice Button Animationen */
@keyframes shake {
  0%, 100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-5px) rotate(-2deg);
  }
  75% {
    transform: translateX(5px) rotate(2deg);
  }
}

.animate-shake {
  animation: shake 0.5s ease-in-out;
}

/* Voice Status Bar */
.voice-status-bar {
  background: linear-gradient(to right, rgba(239, 68, 68, 0.05), rgba(239, 68, 68, 0.1));
}

.pulse-dot {
  animation: pulse-dot 1.5s ease-in-out infinite;
}

@keyframes pulse-dot {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.5;
    transform: scale(1.2);
  }
}

/* Custom Scrollbar Styling */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: var(--lc-primary-300) transparent;
}

.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: var(--lc-primary-300);
  border-radius: 3px;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: var(--lc-primary-400);
}

.scrollbar-thumb-lc-primary-300::-webkit-scrollbar-thumb {
  background-color: var(--lc-primary-300);
}

.scrollbar-track-transparent::-webkit-scrollbar-track {
  background: transparent;
}

/* 9:16 Portrait Layout */
.kaya-portrait {
  position: relative;
  width: min(100vw, 540px);
  aspect-ratio: 9/16;
  height: min(100svh, 960px);
  margin: 0 auto;
  border-radius: 20px;
  overflow: hidden;
  background: #fff;
  box-shadow: 0 12px 40px rgba(0,0,0,.08);
  display: grid;
  grid-template-rows: 62% 38%;
  min-height: 0; /* Grid-Scroll-Fix: Kinder dürfen schrumpfen */
}

/* Mobile: Volle Breite auf sehr schmalen Screens */
@media (max-width: 540px) {
  .kaya-portrait {
    width: 100vw;
    border-radius: 0;
  }
  
  .utility-bar {
    width: calc(100vw - 16px);
  }
}

/* AVATAR-BEREICH (oben) */
#avatarPane {
  position: relative;
  z-index: 0; /* sicherer Layer-Start */
  min-height: 0; /* Grid-Scroll-Fix */
  background: radial-gradient(1200px 600px at 30% 35%, #eef5f7, #e8eef2 60%, #e6eaee);
}

#babylon-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  display: block;
  z-index: 1;
}

.avatar-shadow {
  position: absolute;
  left: 0;
  right: 0;
  bottom: -1px;
  height: 40px;
  pointer-events: none;
  background: linear-gradient(to bottom, rgba(0,0,0,.08), rgba(0,0,0,0));
  z-index: 2;
}

/* CHAT-BEREICH (unten) */
#chatPane {
  position: relative;
  z-index: 1;
  min-height: 0; /* Grid-Scroll-Fix: verhindert „zieht nach oben“ */
  overflow: hidden; /* Scroll nur in .messages */
  display: grid;
  grid-template-rows: 1fr auto;
  background: #fff;
}

/* Überlappungs-Naht (Seam) – Avatar & Chat laufen gegeneinander */
.seam {
  position: absolute;
  left: 0;
  right: 0;
  top: calc(62% - 90px); /* 90px statt 72px = mehr Überlappung */
  width: 100%;
  height: 90px;
  z-index: 3; /* sicher über Avatar & Chat (avatar-shadow ist z-index:2) */
  pointer-events: none;
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,.4) 30%,
    rgba(255,255,255,.8) 60%,
    rgba(255,255,255,1) 100%
  );
  backdrop-filter: blur(3px); /* stärker */
  -webkit-backdrop-filter: blur(3px);
  box-shadow: inset 0 16px 24px -18px rgba(0,0,0,.28); /* stärker */
}

/* Mobile: Safe Area Support */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .kaya-portrait {
    padding-bottom: env(safe-area-inset-bottom, 0);
  }
}

/* HiDPI Schärfe */
/* Frame Container (umgibt kaya-portrait + Utility-Bar) */
.kaya-frame {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100svh;
  overflow: hidden;
}

/* Utility-Bar (über Avatar-Kopf) */
.utility-bar {
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: min(100vw, 560px);
  padding: 6px 8px;
  display: flex;
  gap: 8px;
  align-items: center;
  background: rgba(255, 255, 255, 0.75);
  border: 1px solid rgba(0, 0, 0, 0.06);
  border-radius: 999px;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
  z-index: 10;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

.utility-bar button {
  height: 34px;
  padding: 0 12px;
  border-radius: 999px;
  border: 1px solid var(--lc-border, #E2E8F0);
  background: #fff;
  color: var(--lc-ink-900, #0F172A);
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.utility-bar button:hover {
  background: var(--lc-neutral-50, #F7FAFB);
  transform: scale(1.05);
}

.utility-bar button.active {
  background: var(--lc-primary-100, #CCF3EF);
  color: var(--lc-primary-700, #0B5C56);
  font-weight: 700;
}

.utility-bar .spacer {
  flex: 1;
}

/* Composer: Send + Mic Button-Klassen */
.composer .send {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: 0;
  background: var(--lc-primary-600, #0F766E);
  color: #fff;
  box-shadow: 0 6px 16px rgba(15, 118, 110, 0.28);
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.composer .send:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px rgba(15, 118, 110, 0.4);
}

.composer .mic {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: 1px solid var(--lc-border, #E2E8F0);
  background: #fff;
  color: var(--lc-primary-700, #0B5C56);
  font-size: 20px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.composer .mic:hover {
  background: var(--lc-primary-50, #F0FDFA);
  transform: scale(1.05);
}

.composer .mic.recording {
  background: #ef4444;
  color: #fff;
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

@media (min-resolution: 2dppx) {
  #babylon-canvas {
    image-rendering: -webkit-optimize-contrast;
  }
}

/* Chat-Nachrichten – ohne Top-Mask (echte Überlappung) */
.messages {
  overflow: auto;
  padding: 12px 14px 0;
  min-height: 0; /* Grid-Scroll-Fix */
  overscroll-behavior: contain; /* kein Überscroll ins Canvas */
  -webkit-overflow-scrolling: touch; /* smooth auf iOS */
}

/* Chat-Nachrichten Styling mit CI-Farben */
.bot {
  max-width: 68ch;
  background: #ECF9F7;
  border: 1px solid #C8EEE7;
  color: var(--lc-ink-900);
  padding: 10px 12px;
  border-radius: 16px;
  margin-bottom: 8px;
}

.user {
  max-width: 60ch;
  margin-left: auto;
  background: var(--lc-ink-900);
  color: #fff;
  padding: 10px 12px;
  border-radius: 16px;
  margin-bottom: 8px;
}

/* Composer Styling mit CI-Farben */
.composer {
  display: flex;
  gap: 8px;
  align-items: center;
  padding: 12px 14px 16px; /* erhöhter Padding für bessere Touch-Targets */
  border-top: 1px solid var(--lc-border);
}

.composer input {
  flex: 1;
  height: 42px;
  border-radius: 999px;
  border: 1px solid var(--lc-border);
  padding: 0 14px;
  color: var(--lc-ink-900);
}

.composer button {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--lc-primary-600);
  color: #fff;
  border: 0;
  cursor: pointer;
  transition: background 0.2s;
  box-shadow: 0 6px 16px rgba(15,118,110,.28);
}

.composer button:hover {
  background: var(--lc-primary-700);
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
  body.reduced-motion *,
  body.reduced-motion *::before,
  body.reduced-motion *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High Contrast Support */
body.high-contrast {
  --lc-primary-600: #000;
  --lc-bg-50: #fff;
  --lc-ink-900: #000;
  --lc-border: #000;
}

body.high-contrast .bot {
  background: #fff;
  border: 2px solid #000;
  color: #000;
}

body.high-contrast .user {
  background: #000;
  border: 2px solid #000;
  color: #fff;
}
